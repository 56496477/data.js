/*!
 * data.js v0.2.1 (https://github.com/yanhaijing/data.js)
 * Copyright 2013 yanhaijing. All Rights Reserved
 * Licensed under MIT (https://github.com/yanhaijing/data.js/blob/master/MIT-LICENSE.txt)
 */
!function(a,b){var c=b(a);if("function"==typeof define&&define.amd)define("data",function(){return c});else if("object"==typeof exports)module.exports=c;else{var d=a.Data;c.noConflict=function(){return a.Data===c&&(a.Data=d),c},a.Data=c}}(this,function(){"use strict";function a(a){if(null===a)return"null";var b=typeof a;if("object"!==b)return b;var c=l.call(a).slice(8,-1).toLowerCase();return"object"!==c?c:a.constructor===Object?c:"unkonw"}function b(b){return"function"===a(b)}function c(b){return Array.isArray?Array.isArray(b):"array"===a(b)}function d(b){return"object"===a(b)}function e(){for(var a,b,f=arguments[0]||{},g=j.call(arguments,1),h=g.length,i=0;h>i;i++){var k=g[i];for(var l in k){var m=f[l],n=k[l];f!==n&&(n&&(d(n)||(a=c(n)))?(a?(a=!1,b=m&&c(m)?m:[]):b=m&&d(m)?m:{},f[l]=e(b,n)):"undefined"!=typeof n&&(f[l]=n))}}return f}function f(a,b,e,g){var h;for(var j in g){var k,l=e[j],m=g[j],n=!1,o=!1;e!==m&&("undefined"==typeof m?o=!0:"undefined"==typeof e[j]&&(n=!0),h=("undefined"==typeof a?"":a+".")+j,m&&(d(m)||(k=c(m)))?(k?(k=!1,e[j]=l&&c(l)?l:[]):e[j]=l&&d(l)?l:{},e[j]=f(h,b,e[j],m)):e[j]=m,i(b,"set",h,e[j]),o?i(b,"delete",h,e[j]):n?i(b,"add",h,e[j]):i(b,"update",h,e[j]))}return e}function g(a){return a.split(".")}function h(a){return d(a)?e({},a):c(a)?e([],a):a}function i(a,b,c,e){if(a=a[b][c],d(a))for(var f in a)a.hasOwnProperty(f)&&a[f]({type:b,key:c,data:e})}var j=[].slice,k={},l=k.toString,m=(k.hasOwnProperty,0),n=function(){return this instanceof n?void this._init():new n};e(n.prototype,{_init:function(){this._context={},this._events={set:{},"delete":{},add:{},update:{}}},set:function(a,b){var e=this._context;if("string"!=typeof a)return!1;var h,i,j=g(a),k=j.length,l=0;if(2>k)return i={},i[a]=b,f(void 0,this._events,e,i),!0;for(;k-1>l;l++){if(h=j[l],!c(e[h])&&!d(e[h])){if("undefined"==typeof b)return!1;e[h]=isNaN(Number(h))?{}:[]}e=e[h]}return h=j.pop(),i=c(e)?[]:{},i[h]=b,e=f(j.join("."),this._events,e,i),!0},get:function(a){if("string"!=typeof a)return void 0;for(var b,c=g(a),d=c.length,e=0,f=this._context;d>e;e++)if(b=c[e],f=f[b],"undefined"==typeof f||null===f)return f;return h(f)},has:function(a){return"undefined"==typeof this.get(a)?!1:!0},sub:function(a,c,d){if("string"!=typeof a||"string"!=typeof c||!b(d))return-1;if(!(a in this._events))return-2;var e=this._events[a];return e[c]=e[c]||{},e[c][m++]=d,m-1},unsub:function(a,b,c){if("string"!=typeof a||"string"!=typeof b)return!1;if(!(a in this._events))return!1;var e=this._events[a];return d(e[b])?"number"!=typeof c?(delete e[b],!0):(delete e[b][c],!0):!1}});var o=new n;return e(n,{version:"0.2.1",has:function(a){return o.has(a)},get:function(a){return o.get(a)},set:function(a,b){return o.set(a,b)},sub:function(a,b,c){return o.sub(a,b,c)},unsub:function(a,b,c){return o.unsub(a,b,c)}}),n});